(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(module,__webpack_exports__,__webpack_require__){"use strict";var axios__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(112),axios__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);axios__WEBPACK_IMPORTED_MODULE_0___default.a.defaults.baseURL="https://magpiee.com.cn:28443",axios__WEBPACK_IMPORTED_MODULE_0___default.a.interceptors.response.use(function(response){return response.data},function(error){return Promise.reject(error)}),__webpack_exports__.a=axios__WEBPACK_IMPORTED_MODULE_0___default.a},258:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return DemoContainer});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))),ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function DemoContainer(_ref){var children=_ref.children,style=_ref.style;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:_objectSpread({minHeight:500,justifyContent:"center",alignItems:"center",display:"flex"},style)},children)}DemoContainer.__docgenInfo={description:"",methods:[],displayName:"DemoContainer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["tools/DemoContainer/index.js"]={name:"DemoContainer",docgenInfo:DemoContainer.__docgenInfo,path:"tools/DemoContainer/index.js"})},266:function(module,exports){module.exports="## 何时使用\n\n多级地址选择，且支持地址搜索，可以使用`AddressSelector`：\n\n### Properties\n\n| 参数        | 说明                             | 类型               | 默认值 |\n| ----------- | -------------------------------- | ------------------ | ------ |\n| topTabData  | `Array<GroupData>`参考上面的结构 | `Array`            |        |\n| value       | 选择的`item`值                   | `Array<Item>`      |        |\n| style       | 样式对象                         | `CSSProperties`    |        |\n| className   | 样式类                           | `String/Object`    |        |\n| placeholder | 输入框提示语                     | `String/ReactNode` |        |\n| addonAfter  | 输入框后置标签                   | `String/ReactNode` |        |\n| hint        | `Tab`选择下拉框上方的提示语      | `String/ReactNode` |        |\n\n### Events\n\n| 参数     | 说明                       | 类型                    | 默认值 |\n| -------- | -------------------------- | ----------------------- | ------ |\n| onSearch | 搜索地址接口               | function(params)        | 无     |\n| onChange | 选择的`Item`发生变化的事件 | function(selectedItems) | 无     |\n\n\n### Models\n\n`GroupData`定义如下：\n\n```json\n{\n  code: string,       // 此Tab的code\n  name: string,       // 此Tab的名称\n  maxLevel: number   // 此Tab最大可选择到的级别\n}\n```\n"},267:function(module,__webpack_exports__,__webpack_require__){"use strict";var _storybook_theming__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(268);__webpack_exports__.a=Object(_storybook_theming__WEBPACK_IMPORTED_MODULE_0__.create)({brandImage:"",brandTitle:"Antd Pro Biz"})},271:function(module,exports,__webpack_require__){__webpack_require__(272),__webpack_require__(358),module.exports=__webpack_require__(359)},359:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76),_theme__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(267),req=__webpack_require__(432);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.addParameters)({options:{theme:_theme__WEBPACK_IMPORTED_MODULE_1__.a}}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)(function loadStories(){req.keys().forEach(function(filename){return req(filename)})},module)}.call(this,__webpack_require__(186)(module))},432:function(module,exports,__webpack_require__){var map={"./address.stories.js":433};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=432},433:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__.d(__webpack_exports__,"withStorySource",function(){return withStorySource}),__webpack_require__.d(__webpack_exports__,"__STORY__",function(){return __STORY__}),__webpack_require__.d(__webpack_exports__,"__ADDS_MAP__",function(){return __ADDS_MAP__});__webpack_require__(434);var antd_lib_icon__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(160),antd_lib_icon__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(antd_lib_icon__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_storybook_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(76),_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(574),_components_AddressSelector_README_md__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(266),_components_AddressSelector_README_md__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_components_AddressSelector_README_md__WEBPACK_IMPORTED_MODULE_5__),_tools_DemoContainer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(258),_http__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(161);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var withStorySource=__webpack_require__(440).withStorySource,__STORY__="import React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport { AddressSelector } from '../components';\nimport addressDoc from '../components/AddressSelector/README.md';\nimport DemoContainer from '../tools/DemoContainer';\nimport { Icon } from 'antd';\nimport axios from '../http';\n\nclass Demo1 extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      groups: [],\n    };\n  }\n\n  componentDidMount() {\n    this.initGroups();\n  }\n\n  handleSearch = params => {\n    return axios.get('/api/v1/areas/search', {\n      params,\n    });\n  };\n\n  handleSearchGroup = params => {\n    return axios.get('/api/v1/areas/search/group', {\n      params,\n    });\n  };\n\n  initGroups = async () => {\n    let { groups } = this.state;\n    let resGroup = await this.handleSearchGroup({ type: 1 });\n    if (resGroup.errorCode === 0) {\n      groups = resGroup.data.map(g => {\n        if (g.code == '0') {\n          g.maxLevel = 4;\n        } else if (g.code == '1') {\n          g.maxLevel = 3;\n        } else {\n          g.maxLevel = 2;\n        }\n        return g;\n      });\n    }\n    this.setState({ groups });\n  };\n\n  handleChange = selectedItems => {\n    console.log(selectedItems);\n  };\n\n  render() {\n    const { groups } = this.state;\n\n    let test = [\n      {\n        areaCode1: 'CN',\n        areaCode2: '130000',\n        areaCode3: '130600',\n        areaCode4: null,\n        areaName1: '中国',\n        areaName2: '河北省',\n        areaName3: '保定市',\n        areaName4: null,\n        code: '130600',\n        groupCode: '0',\n        id: 54,\n        level: 3,\n        name: '保定市',\n        parentCode: '130000',\n      },\n      {\n        areaCode1: 'CN',\n        areaCode2: '130000',\n        areaCode3: '130600',\n        areaCode4: '130602',\n        areaName1: '中国',\n        areaName2: '河北省',\n        areaName3: '保定市',\n        areaName4: '竞秀区',\n        code: '130602',\n        groupCode: '0',\n        id: null,\n        level: 4,\n        name: '竞秀区',\n        parentCode: '130600',\n      },\n    ];\n\n    return (\n      <DemoContainer>\n        <AddressSelector\n          type={1}\n          topTabData={groups}\n          onSearch={this.handleSearch}\n          onChange={this.handleChange}\n          placeholder=\"请选择地址\"\n          addonAfter={<Icon type=\"ellipsis\" />}\n          value={test}\n          style={{ width: 500 }}\n          hint=\"温馨提示：支持中文、拼音或首字母，如：西安 或 XA\"\n        />\n      </DemoContainer>\n    );\n  }\n}\nstoriesOf('Address', module).add('AddressSelector', () => <Demo1 />, { notes: addressDoc });\n",__ADDS_MAP__={"address--addressselector":{startLoc:{col:33,line:110},endLoc:{col:90,line:110}}},Demo1=function(_React$Component){function Demo1(props){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Demo1),(_this=_possibleConstructorReturn(this,_getPrototypeOf(Demo1).call(this,props))).handleSearch=function(params){return _http__WEBPACK_IMPORTED_MODULE_7__.a.get("/api/v1/areas/search",{params:params})},_this.handleSearchGroup=function(params){return _http__WEBPACK_IMPORTED_MODULE_7__.a.get("/api/v1/areas/search/group",{params:params})},_this.initGroups=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var groups,resGroup;return regeneratorRuntime.wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return groups=_this.state.groups,_context.next=3,_this.handleSearchGroup({type:1});case 3:0===(resGroup=_context.sent).errorCode&&(groups=resGroup.data.map(function(g){return"0"==g.code?g.maxLevel=4:"1"==g.code?g.maxLevel=3:g.maxLevel=2,g})),_this.setState({groups:groups});case 6:case"end":return _context.stop()}},_callee)})),_this.handleChange=function(selectedItems){console.log(selectedItems)},_this.state={groups:[]},_this}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Demo1,react__WEBPACK_IMPORTED_MODULE_2___default.a.Component),function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(Demo1,[{key:"componentDidMount",value:function componentDidMount(){this.initGroups()}},{key:"render",value:function render(){var groups=this.state.groups;return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_tools_DemoContainer__WEBPACK_IMPORTED_MODULE_6__.a,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_components__WEBPACK_IMPORTED_MODULE_4__.a,{type:1,topTabData:groups,onSearch:this.handleSearch,onChange:this.handleChange,placeholder:"请选择地址",addonAfter:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(antd_lib_icon__WEBPACK_IMPORTED_MODULE_1___default.a,{type:"ellipsis"}),value:[{areaCode1:"CN",areaCode2:"130000",areaCode3:"130600",areaCode4:null,areaName1:"中国",areaName2:"河北省",areaName3:"保定市",areaName4:null,code:"130600",groupCode:"0",id:54,level:3,name:"保定市",parentCode:"130000"},{areaCode1:"CN",areaCode2:"130000",areaCode3:"130600",areaCode4:"130602",areaName1:"中国",areaName2:"河北省",areaName3:"保定市",areaName4:"竞秀区",code:"130602",groupCode:"0",id:null,level:4,name:"竞秀区",parentCode:"130600"}],style:{width:500},hint:"温馨提示：支持中文、拼音或首字母，如：西安 或 XA"}))}}]),Demo1}();Object(_storybook_react__WEBPACK_IMPORTED_MODULE_3__.storiesOf)("Address",module).addDecorator(withStorySource(__STORY__,__ADDS_MAP__)).add("AddressSelector",function(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(Demo1,null)},{notes:_components_AddressSelector_README_md__WEBPACK_IMPORTED_MODULE_5___default.a})}.call(this,__webpack_require__(186)(module))},574:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AddressSelector});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),antd_pro_toolkit__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(575),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&(t[p[i]]=s[p[i]])}return t};class AddressSelector extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){super(props),this.initDataSource=((topTabData,value)=>__awaiter(this,void 0,void 0,function*(){let{dataSource:dataSource}=this.state,hotCities=[];if(0==hotCities.length){let resFirst=yield this.searchArea({isHot:!0});hotCities=resFirst.data||[],this.setState({hotCities:hotCities})}dataSource=topTabData.map(g=>{let dataItem={title:g.name,maxLevel:g.maxLevel,code:g.code,items:[]};return"0"===g.code?dataItem.items=[{title:"常用市",level:3,entry:!1,items:hotCities},{title:"省/直辖市",level:2,entry:!1,items:[]}]:"1"===g.code?dataItem.items=[{title:"港澳台",level:2,entry:!1,items:[]}]:"2"===g.code&&(dataItem.items=[{title:"海外",level:1,entry:!1,items:[]}]),dataItem}),value&&value.length>0&&this.setInitialValue(dataSource,value),this.setState({dataSource:dataSource})})),this.setInitialValue=((dataSource,value)=>__awaiter(this,void 0,void 0,function*(){let groupCode=value[0].groupCode,panelData=dataSource.find(panelData=>panelData.code==groupCode);if(panelData&&panelData.items.length>0){panelData.items=this.handlePatchPanelData(panelData.items,value[value.length-1]);let valueIdx=0;for(let i=0;i<panelData.items.length;i++){let panelIdx=i;"0"==groupCode&&panelIdx++;let dataItem=panelData.items[panelIdx];if(dataItem.entry=!0,dataItem.level===value[valueIdx].level){if(dataItem.title=value[valueIdx].name,valueIdx==value.length-1){let res=yield this.searchArea({parentCode:value[valueIdx].parentCode,level:value[valueIdx].level});0===res.errorCode&&(dataItem.items=res.data);break}valueIdx++}}for(let j=0;j<dataSource.length;j++)if(dataSource[j].code==groupCode){dataSource[j]=panelData;break}this.setState({dataSource:dataSource})}})),this.searchArea=(_a=>__awaiter(this,void 0,void 0,function*(){var{isHot:isHot=!1,pageSize:pageSize=999}=_a,rest=__rest(_a,["isHot","pageSize"]);const{type:type,onSearch:onSearch}=this.props;return yield onSearch(Object.assign({isHot:isHot,pageSize:pageSize,type:type},rest))})),this.handleSearch=(val=>__awaiter(this,void 0,void 0,function*(){return(yield this.searchArea({content:val})).data})),this.handleTopTabChange=(topKey=>{const{dataSource:dataSource}=this.state;let tabData=dataSource[topKey].items;0!=topKey&&tabData.length>0&&0===tabData[0].items.length&&this.searchArea({groupCode:dataSource[topKey].code,level:tabData[0].level}).then(res=>{tabData[0].items=res.data,dataSource[topKey].items=tabData,this.setState({dataSource:dataSource})})}),this.handleTabChange=((key,topKey,item)=>{const{dataSource:dataSource}=this.state;let tabData=dataSource[topKey].items,level=tabData[key].level,query={groupCode:dataSource[topKey].code};return 0==key&&"0"==dataSource[topKey].code?query.isHot=!0:item?query.parentCode=item.parentCode:query.level=level,this.searchArea(query).then(res=>(tabData[key].items=res.data,0==topKey&&key>0&&(tabData=tabData.slice(0,key+1)),dataSource[topKey].items=tabData,this.setState({dataSource:dataSource}),res))}),this.buildDataSource=((key,topKey,item,data)=>{let{dataSource:dataSource}=this.state,tabData=dataSource[topKey].items,currentData=tabData[key];return 0==key&&0==topKey?((tabData=tabData.slice(0,key+2))[1].title="省/直辖市",tabData[1].entry=!1):((tabData=tabData.slice(0,key+1))[0].entry=!1,tabData[key].title=item.name),4!==item.level&&tabData.push({title:"请选择",level:currentData.level+1,entry:!1,items:data}),tabData[key].entry=!0,dataSource[topKey].items=tabData,this.setState({dataSource:dataSource}),dataSource}),this.handleItemClick=((key,topKey,item)=>{let{dataSource:dataSource}=this.state;return item.level===dataSource[topKey].maxLevel?(dataSource[topKey].items[key].title=item.name,dataSource[topKey].items[key].entry=!0,this.setState({dataSource:dataSource}),Promise.resolve(dataSource[topKey].items.length-1)):this.searchArea({groupCode:item.groupCode,parentCode:item.code,level:item.level+1}).then(res=>{this.buildDataSource(key,topKey,item,res.data)})}),this.handleSearchItemClick=(item=>{let{dataSource:dataSource}=this.state,gCode=Number(item.groupCode),maxLevel=dataSource[gCode].maxLevel,groupData=dataSource[gCode].items;return groupData=this.handlePatchPanelData(groupData,item),(()=>__awaiter(this,void 0,void 0,function*(){for(let i=0;i<groupData.length;i++){let dataItem=groupData[i];if(0==gCode&&0==i){dataItem.entry=!1;continue}let level=dataItem.level;dataItem.title=level===item.level?item.name:item[`areaName${level}`],dataItem.entry=!0,dataItem.items=[]}let query={groupCode:item.groupCode};item.level!==maxLevel?(query.parentCode=item.code,query.level=item.level+1):(query.parentCode=item.parentCode,query.level=item.level);let res=yield this.searchArea(query);return item.level!==maxLevel?groupData.push({title:"请选择",level:item.level+1,entry:!1,items:res.data}):groupData[groupData.length-1].items=res.data,groupData}))().then(()=>{dataSource[gCode].items=groupData,this.setState({dataSource:dataSource})})}),this.handlePatchPanelData=((tabDatas,lastItem)=>{let lastData=tabDatas[tabDatas.length-1],betweenLastLevel=lastItem.level-lastData.level;if(betweenLastLevel>0)for(let i=lastData.level+1;i<=lastItem.level;i++)tabDatas.push({title:"",level:i,entry:!1,items:[]});else tabDatas=tabDatas.slice(0,tabDatas.length-Math.abs(betweenLastLevel));return tabDatas}),this.state={hotCities:[],dataSource:[]}}componentDidMount(){const{topTabData:topTabData,value:value}=this.props;topTabData&&topTabData.length>0&&this.initDataSource(topTabData,value)}componentWillReceiveProps(nextProps){const{topTabData:topTabData,value:value}=nextProps;this.initDataSource(topTabData,value)}render(){const{dataSource:dataSource}=this.state,{placeholder:placeholder,hint:hint,addonAfter:addonAfter,style:style,className:className,onChange:onChange,value:value}=this.props;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(antd_pro_toolkit__WEBPACK_IMPORTED_MODULE_1__.a,{onTabChange:this.handleTabChange,onTopTabChange:this.handleTopTabChange,onItemClick:this.handleItemClick,onSearchItemClick:this.handleSearchItemClick,onSearch:this.handleSearch,onChange:onChange,value:value,style:style,className:className,dataSource:dataSource,placeholder:placeholder,addonAfter:addonAfter,hint:hint})}}}},[[271,1,2]]]);
//# sourceMappingURL=main.eb7b8489310da071f82c.bundle.js.map